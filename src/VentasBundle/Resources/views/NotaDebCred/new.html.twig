{% extends "AppBundle::layout.html.twig" %}
{% block pageheader %}

{% block extra_css %}
<link rel="stylesheet" href="{{ asset('assets/css/style.ventas.css') }}" type="text/css" media="all" />
{% endblock %}

<div class="pageheader notab">
    <h1 class="pagetitle">Notas de Débito y Crédito
        <span class="floatright fechahora">
            {{entity.fecha|date('d/m/Y')}}
            <span class="js-hora"> {{entity.fecha|date('H:i:s')}}</span> &nbsp; | &nbsp; {{app.user.username}}
        </span>
    </h1>
</div><!--pageheader-->
{% endblock %}

{% block contentwrapper %}
<div id="contentwrapper" class="contentwrapper">
{% include "AppBundle::notificacion.html.twig" %}
<div class="divForm">
   {{ form_start(form, {'attr': {'class': 'form-horizontal','id':'ventasbundle_notadebcred'}}) }}

    <fieldset class="fields" >
        {% include "VentasBundle:Partial:block-cliente.html.twig" %}

        {% include "VentasBundle:Partial:block-moneda.html.twig" %}

        {% include "VentasBundle:Partial:block-formapago.html.twig" %}

    </fieldset>
    <fieldset>

        <div class="datos-cliente" style="display:none" >
            {% include "VentasBundle:Partial:_partial-datos-cliente.html.twig" with {'item':entity.cliente} %}
        </div>

        {% include "VentasBundle:Partial:_partial-datos-cf.html.twig" %}

        <div class="datos-formapago">
            {% include "VentasBundle:Partial:_partial-datos-formapago.html.twig" with {'item':entity.formaPago}  %}
        </div>
    </fieldset>

    <fieldset class="fields" >
        <div style="display:inline-block; width: 25%;">
            {{ form_row(form.notaElectronica.tipoComprobante) }}
        </div>
        <div style="display:inline-block; width: 50%;">
            <div>
            {{ form_label(form.facturas)  }}
            {{ form_widget(form.facturas, { 'attr': { 'class' : 'select2', 'tabindex':'0', 'style':'width:90%'} }) }}
            </div>
        </div>
        <div style="display:inline-block; width:20%;">
            {{ form_row(form.precioLista) }}
        </div>
    </fieldset>

    <fieldset>
        <div style="padding-top: 20px; margin:auto; width: 100%;">
            {{ form_errors(form.detalles) }}
            {% include "VentasBundle:Partial:_partial-detalle.html.twig" %}
        </div>
    </fieldset>
    <fieldset>
        <div style="margin:auto; width: 100%;">
            {% include "VentasBundle:Partial:_partial-resumen.html.twig" with {'showiva': false, 'showiibb': false } %}
        </div>
    </fieldset>

    <fieldset>
        <br clear="all" />
        <div class="actionbutton">
            <button class="guardar tabbable" type="submit">GUARDAR</button>
            <a class="cancelar tabbable" type="button" href="{{ path('ventas_notadebcred')}}">Cancelar</a>
        </div>
    </fieldset>

    {% include "VentasBundle:Partial:_partial-notifmsg.html.twig" %}

    <div name="rest" class="hiddenformrest">{{ form_rest(form) }}</div>
  {{ form_end(form) }}
</div>
</div>
{% endblock %}
{% block extra_javascripts %}
{% include "AppBundle::block-list-js.html.twig" %}
<script type="text/javascript" src="{{ asset('assets/js/custom/ventas.js') }}"></script>
<script type="text/javascript">
jQuery(function ($) {
    $(window).on('load', function () {
        $('.datos-cliente').hide();
        $('.datos-cf').show();
        $('#ventasbundle_notadebcred_nombreCliente').attr('required',true);
        $('#ventasbundle_notadebcred_nombreCliente').css('width', '95%')

        // confirm on submit
        $('#ventasbundle_notadebcred').on('submit', function(){
            if( $('tbody tr.item').length > 0 ){
                if (!confirm('Confirma la generación de la Nota Electrónica?')) {
                return false;
                }
            }else{  alert('Debe ingresar items a la Nota'); return false;}
        })
    });
});
</script>{% endblock %}